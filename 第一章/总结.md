



## 　　　　　　　　　　　知识点梳理

### 1. 过拟合与正则化

>过拟合：如果一味的追求提高对训练数据的预测能力，所选择的模型的复杂度往往会比真模型更高，这种现象称为过拟合（over-fitting）。过拟合是指学习时选择的模型包含的参数过多，以致于出现这一模型对已知数据预测得很好，但对于未知数据预测很差的现象。如下图：

![1562634308198](/home/gavin/.config/Typora/typora-user-images/1562634308198.png)

​	上图中模型对于训练数据拟合的很好，但是对于测试数据的误差出现了先减小后增大的现象，这使得模型的泛化能力较差，即过拟合。

#### 1.1 过拟合与模型选择的实例

>**描述最小二乘法**：一般的H(x)为n次的多项式，9$H(x)=w_0+w_1x+w_2x^2+...w_nx^n$
>
>$w(w_0,w_1,w_2,...,w_n)$为参数
>
>最小二乘法就是要找到一组 $w(w_0,w_1,w_2,...,w_n)$ 使得$\sum_{i=1}^n(h(x_i)-y_i)^2$ (残差平方和) 最小
>
>即，求 $min\sum_{i=1}^n(h(x_i)-y_i)^2$
>
>[最小二乘法链接](https://blog.csdn.net/ccnt_2012/article/details/81127117)

​		我们尝试用目标函数y=sin2πx, 加上一个正太分布的噪音干扰，用多项式去拟合。（Ｍ表示生成多项式的次数）

| ![](/home/gavin/Machine/机器学习理论/code /第一章/欠拟合（效果最差）.png) | ![](/home/gavin/Machine/机器学习理论/code /第一章/欠拟合（效果差）.png) |
| ------------------------------------------------------------ | :----------------------------------------------------------- |
| ![拟合](/home/gavin/Machine/机器学习理论/code /第一章/拟合.png) | ![过拟合](/home/gavin/Machine/机器学习理论/code /第一章/过拟合.png) |

​	上述图左上角的和右上角的图中，分别为M = 0和M = 1 时，生成的多项式对目标函数的的拟合程度，从图中可以看出当M = 0和Ｍ＝1时，出现了拟合的状态，使得多项式不能够很好的拟合目标函数。而当M = 3时(左下角），此时生成多项式很好的拟合了目标函数，虽然对于目标函数中的个别数据不能够完全拟合，但是这样的拟合效果确实是非常好的。在M=9时（右下角），此时生成多项式拟合到了每一个数据点，这样使得出现了过拟合现象，所以此时需要加入正则化来**削弱**过拟合。

####　1.2 正则化

>正则化：拟合过程中通常都倾向于让权值尽可能小，最后构造一个所有参数都比较小的模型。因为一般认为参数值小的模型比较简单，能适应不同的数据集，也在一定程度上避免了过拟合现象。可以设想一下对于一个线性回归方程，若参数很大，那么只要数据偏移一点点，就会对结果造成很大的影响；但如果参数足够小，数据偏移得多一点也不会对结果造成什么影响，专业一点的说法是『抗扰动能力强』。
>
>[正则化](https://blog.csdn.net/jinping_shi/article/details/52433975)

​	上图右下角结果显示过拟合， 引入正则化项(regularizer)，降低过拟合

​			$Q(x)=\sum_{i=1}^{n}\left(h\left(x_{i}\right)-y_{i}\right)^{2}+\lambda\|w\|_{0}^{2}$

​	回归问题中，损失函数是平方损失，正则化可以是参数向量的L2范数,也可以是L1范数。

- L1: regularization*abs(p)
- L2: 0.5 * regularization * np.square(p)

| ![正则化](/home/gavin/Machine/机器学习理论/code /第一章/正则化.png) | ![过度正则化](/home/gavin/Machine/机器学习理论/code /第一章/过度正则化.png) |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|                            正则化                            |                          过度正则化                          |

​	在上图中当正则化系数为0.001时（左图），此时正则化效果明显，使得多项式不过度拟合目标函数，从而达到削弱过拟合，而在正则化系数为10时（右图），此时出现了欠拟合状态，因为此时的正则化项在式子中起到了主导作用，使得正则化的影响过大，造成多项式不能够拟合目标函数，所以，选择适当的正则化系数是非常重要的。

